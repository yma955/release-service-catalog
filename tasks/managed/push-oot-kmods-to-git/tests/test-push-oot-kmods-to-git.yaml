---
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: test-push-oot-kmods-to-git
spec:
  description: |
    Run the push-oot-kmods-to-git task and verify the results
  params:
    - name: dataDir
      description: The location where data will be stored
      type: string
      default: "/var/workdir/release"
    - name: taskGitUrl
      type: string
      default: "https://github.com/konflux-ci/release-service-catalog.git"
    - name: taskGitRevision
      type: string
      default: "main"
  tasks:
    - name: run-task
      taskRef:
        name: push-oot-kmods-to-git
      params:
        - name: signedKmodsPath
          value: signed-kmods
        - name: dataDir
          value: $(params.dataDir)
        - name: gitRepoUrl
          value: my-repository.mock/kmods-repo
        - name: gitBranch
          value: main
        - name: gitTokenSecret
          value: git-token-secret
        - name: sourceDataArtifact
          value: "mock.registry/mock/artifact:latest"
        - name: taskGitUrl
          value: $(params.taskGitUrl)
        - name: taskGitRevision
          value: $(params.taskGitRevision)