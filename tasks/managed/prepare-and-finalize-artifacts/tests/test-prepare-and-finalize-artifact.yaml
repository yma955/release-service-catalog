---
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: test-prepare-and-finalize-artifacts
spec:
  description: |
    Run the prepare-and-finalize-artifacts task and verify its steps are mocked.
  params:
    - name: dataDir
      description: The location where data will be stored
      type: string
      default: "/var/workdir/release"
    - name: taskGitUrl
      type: string
      default: "https://github.com/konflux-ci/release-service-catalog.git"
    - name: taskGitRevision
      type: string
      default: "main"
  tasks:
    - name: run-task
      taskRef:
        name: prepare-and-finalize-artifacts
      params:
        - name: dataDir
          value: $(params.dataDir)
        - name: ociStorage
          value: "mock.registry/test-repo/my-artifact"
        - name: ociArtifactExpiresAfter
          value: "1d"
        - name: orasOptions
          value: "--insecure"
        - name: baseDataArtifact
          value: "test-base-artifact"
        - name: rpmDataArtifact
          value: "test-rpm-artifact"
        - name: trustedArtifactsDebug
          value: ""
        - name: taskGitUrl
          value: $(params.taskGitUrl)
        - name: taskGitRevision
          value: $(params.taskGitRevision)